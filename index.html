<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Request for Proposal (Commercial PV)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #000000;
            color: #fff;
            padding: 20px;
        }
        h1 {
            color: #ffffff;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input[type="text"], input[type="email"], select {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
            border: 1px solid #212120;
            border-radius: 4px;
        }
        .required {
            color: red;
        }
        .optional {
            color: gray;
        }
        .btn-submit, .btn-new, .btn-dashboard {
            background-color: #212120;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .hidden {
            display: none;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>
<body>

<h1>Request for Proposal (Commercial PV)</h1>

<form id="rfp-form">
    <div class="form-group">
        <label for="rep-name">Rep Name <span class="required">*</span></label>
        <input type="text" id="rep-name" name="repName" required>
    </div>
    <div class="form-group">
        <label for="rep-email">Rep Email <span class="required">*</span></label>
        <input type="email" id="rep-email" name="repEmail" required>
    </div>
    <div class="form-group">
        <label for="customer-name">Customer Name (POC)</label>
        <input type="text" id="customer-name" name="customerName">
    </div>
    <div class="form-group">
        <label for="company-name">Company Name <span class="required">*</span></label>
        <input type="text" id="company-name" name="companyName" required>
    </div>
    <div class="form-group">
        <label for="company-email">Email <span class="required">*</span> <span class="optional">(Email required for tracking)</span></label>
        <input type="email" id="company-email" name="companyEmail">
    </div>
    <div class="form-group">
        <label for="company-address">Company Address <span class="required">*</span></label>
        <input type="text" id="company-address" name="companyAddress" required>
    </div>
    <div class="form-group">
        <select id="state" name="state" required>
            <option value="Alabama">Alabama</option>
            <option value="Alaska">Alaska</option>
            <option value="Arizona">Arizona</option>
            <option value="Arkansas">Arkansas</option>
            <option value="California">California</option>
            <option value="Colorado">Colorado</option>
            <option value="Connecticut">Connecticut</option>
            <option value="Delaware">Delaware</option>
            <option value="Florida">Florida</option>
            <option value="Georgia">Georgia</option>
            <option value="Hawaii">Hawaii</option>
            <option value="Idaho">Idaho</option>
            <option value="Illinois">Illinois</option>
            <option value="Indiana">Indiana</option>
            <option value="Iowa">Iowa</option>
            <option value="Kansas">Kansas</option>
            <option value="Kentucky">Kentucky</option>
            <option value="Louisiana">Louisiana</option>
            <option value="Maine">Maine</option>
            <option value="Maryland">Maryland</option>
            <option value="Massachusetts">Massachusetts</option>
            <option value="Michigan">Michigan</option>
            <option value="Minnesota">Minnesota</option>
            <option value="Mississippi">Mississippi</option>
            <option value="Missouri">Missouri</option>
            <option value="Montana">Montana</option>
            <option value="Nebraska">Nebraska</option>
            <option value="Nevada">Nevada</option>
            <option value="New Hampshire">New Hampshire</option>
            <option value="New Jersey">New Jersey</option>
            <option value="New Mexico">New Mexico</option>
            <option value="New York">New York</option>
            <option value="North Carolina">North Carolina</option>
            <option value="North Dakota">North Dakota</option>
            <option value="Ohio">Ohio</option>
            <option value="Oklahoma">Oklahoma</option>
            <option value="Oregon">Oregon</option>
            <option value="Pennsylvania">Pennsylvania</option>
            <option value="Rhode Island">Rhode Island</option>
            <option value="South Carolina">South Carolina</option>
            <option value="South Dakota">South Dakota</option>
            <option value="Tennessee">Tennessee</option>
            <option value="Texas">Texas</option>
            <option value="Utah">Utah</option>
            <option value="Vermont">Vermont</option>
            <option value="Virginia">Virginia</option>
            <option value="Washington">Washington</option>
            <option value="West Virginia">West Virginia</option>
            <option value="Wisconsin">Wisconsin</option>
            <option value="Wyoming">Wyoming</option>
<!-- City Options will be populated dynamically -->
        </select>
    </div>
    <div class="form-group">
        <label for="city">Nearest City <span class="required">*</span></label>
        <select id="city" name="city" required>
        </select>
    </div>
    <div class="form-group">
        <label for="install-location">Install Location (Coordinates) <span class="optional">(Desired location of Panels)</span></label>
        <input type="text" id="install-location" name="installLocation">
    </div>
    <div class="form-group">
        <label for="usage-type">Usage Type</label>
        <select id="usage-type" name="usageType">
            <option value="monthly">Monthly</option>
            <option value="daily">Daily</option>
        </select>
    </div>
    <div class="form-group">
        <label for="january">January</label>
        <input type="number" id="january" name="january">
    </div>
    <div class="form-group">
        <label for="february">February</label>
        <input type="number" id="february" name="february">
    </div>
    <div class="form-group">
        <label for="march">March</label>
        <input type="number" id="march" name="march">
    </div>
    <div class="form-group">
        <label for="april">April</label>
        <input type="number" id="april" name="april">
    </div>
    <div class="form-group">
        <label for="may">May</label>
        <input type="number" id="may" name="may">
    </div>
    <div class="form-group">
        <label for="june">June</label>
        <input type="number" id="june" name="june">
    </div>
    <div class="form-group">
        <label for="july">July</label>
        <input type="number" id="july" name="july">
    </div>
    <div class="form-group">
        <label for="august">August</label>
        <input type="number" id="august" name="august">
    </div>
    <div class="form-group">
        <label for="september">September</label>
        <input type="number" id="september" name="september">
    </div>
    <div class="form-group">
        <label for="october">October</label>
        <input type="number" id="october" name="october">
    </div>
    <div class="form-group">
        <label for="november">November</label>
        <input type="number" id="november" name="november">
    </div>
    <div class="form-group">
        <label for="december">December</label>
        <input type="number" id="december" name="december">
    </div>
    <div class="form-group">
        <label for="rfp-delivery-date">RFP Delivery Date</label>
        <input type="datetime-local" 
               id="rfp-delivery-date1" 
               min="2024-01-01T00:00" 
               max="2050-12-31T23:59" 
               step="1">
    </div>
    <button type="submit" class="btn-submitform">Submit</button>

 </div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Define the URL of your CSV file
        const csvUrl = 'https://lckdin-files.s3.us-east-2.amazonaws.com/App/City_State+-+Sheet1+(3).csv';

        // Create a map to hold city data by state
        const stateCityMap = {};

        // Load and parse the CSV file
        Papa.parse(csvUrl, {
            download: true,
            header: true,
            complete: function(results) {
                results.data.forEach(row => {
                    const state = row.State;
                    const city = row.City;

                    if (!stateCityMap[state]) {
                        stateCityMap[state] = [];
                    }
                    stateCityMap[state].push(city);
                });

                // Populate the state dropdown
                populateStateDropdown();
            }
        });

        // Function to populate the state dropdown
        function populateStateDropdown() {
            const states = [
                "Alabama", "Alaska", "Arizona", "Arkansas", "California", "Colorado",
                "Connecticut", "Delaware", "Florida", "Georgia", "Hawaii", "Idaho",
                "Illinois", "Indiana", "Iowa", "Kansas", "Kentucky", "Louisiana",
                "Maine", "Maryland", "Massachusetts", "Michigan", "Minnesota",
                "Mississippi", "Missouri", "Montana", "Nebraska", "Nevada",
                "New Hampshire", "New Jersey", "New Mexico", "New York",
                "North Carolina", "North Dakota", "Ohio", "Oklahoma", "Oregon",
                "Pennsylvania", "Rhode Island", "South Carolina", "South Dakota",
                "Tennessee", "Texas", "Utah", "Vermont", "Virginia",
                "Washington", "West Virginia", "Wisconsin", "Wyoming"
            ];

            const stateDropdown = document.getElementById('state');
            states.forEach(state => {
                const option = document.createElement('option');
                option.value = state;
                option.text = state;
                stateDropdown.add(option);
            });

            // Add event listener to update cities based on selected state
            stateDropdown.addEventListener('change', function() {
                const selectedState = this.value;
                populateCityDropdown(selectedState);
            });
        }

        // Function to populate the city dropdown based on the selected state
        function populateCityDropdown(state) {
            const cityDropdown = document.getElementById('city');
            cityDropdown.innerHTML = ''; // Clear existing options

            if (stateCityMap[state]) {
                stateCityMap[state].forEach(city => {
                    const option = document.createElement('option');
                    option.value = city;
                    option.text = city;
                    cityDropdown.add(option);
                });
            }
        }

        // Handle form submission
        document.getElementById('rfp-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            fetch('https://script.google.com/macros/s/AKfycby6d5uneehm3a29RqscR3P-Nc6t1fF9pvSRfHHXYz-cuL3gMJ1ZdoiyfQ8pudcIDArc/exec', { // Input the web app URL for POST
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    window.location.href = 'confirmation.html'; // Redirect to confirmation page
                } else {
                    return response.text();
                }
            })
            .then(data => {
                if (data) {
                    alert('Error: ' + data);
                }
            })
            .catch(error => console.error('Error:', error));
        });
    });
</script>

</body>
</html>
